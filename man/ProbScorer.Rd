% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{ProbScorer}
\alias{ProbScorer}
\title{Probabilistic Pathway Scoring}
\usage{
ProbScorer(
  counts,
  method = c("nb", "zinb"),
  ncores = 4,
  batch = NULL,
  offset = NULL,
  maxit = 30,
  PathwaySet = c("Metabolism", "Genetic Information Processing",
    "Environmental Information Processing", "Cellular Processes", "Organismal Systems",
    "Human Diseases", "Drug Development")
)
}
\arguments{
\item{counts}{A numeric matrix or data frame of gene expression counts}

\item{method}{Character string specifying the statistical model to use.
Options are:
\describe{
\item{"nb"}{Negative Binomial model (default).}
\item{"zinb"}{Zero-Inflated Negative Binomial model.}
}}

\item{ncores}{Integer specifying the number of CPU cores to use for parallel
computation. Default is 4.}

\item{batch}{Optional vector or factor indicating batch assignment of samples,
used for batch-effect correction. Default is \code{NULL}.}

\item{offset}{Optional numeric matrix of the same dimension as \code{counts},
representing model offsets (e.g., library size normalization factors).
Default is \code{NULL}.}

\item{maxit}{Integer specifying the maximum number of iterations allowed
for model fitting. Default is 30.}

\item{PathwaySet}{Character vector specifying which KEGG (or other database)
pathway categories to include in scoring. Default includes:
\itemize{
\item "Metabolism"
\item "Genetic Information Processing"
\item "Environmental Information Processing"
\item "Cellular Processes"
\item "Organismal Systems"
\item "Human Diseases"
\item "Drug Development"
}}
}
\value{
A list or data frame containing:
\describe{
\item{\code{ScoreMatrix}}{A matrix of pathway activity scores per sample.}
\item{\code{ModelParams}}{Estimated model parameters for each gene.}
\item{\code{Convergence}}{Logical vector indicating model convergence.}
}
}
\description{
Computes probabilistic activity scores for predefined biological pathways
based on count data, using either a negative binomial (NB) or zero-inflated
negative binomial (ZINB) model. Supports multithreading and batch correction.
}
\examples{
\dontrun{
data(example_counts)
result <- ProbScorer(counts = example_counts,
                     method = "nb",
                     ncores = 8,
                     batch = NULL,
                     maxit = 50)
head(result$ScoreMatrix)
}
}
